#SingleInstance
#include ..\Unknown\Unknown.ahk
#include AudioEndpointVolume.ahk
#include MMDevice.ahk
#include MMDeviceCollection.ahk
#include MMDeviceEnumerator.ahk

CLSCTX_ALL := 0x1|0x2|0x4|0x10

enumerator := new MMDeviceEnumerator()
MsgBox % "enumerator: " IsObject(enumerator)
collection := enumerator.EnumAudioEndpoints(2, 0x00000001)
MsgBox % "collection: " IsObject(collection)
device := collection.Item(0)
MsgBox % "device: " IsObject(device)
endpointvolume := device.Activate(AudioEndpointVolume, CLSCTX_ALL)
MsgBox % "volume: " IsObject(endpointvolume)
MsgBox % endpointvolume.SetMasterVolumeLevel(50)